{{> header}}
<br><br><br>
<h1 class="container-fluid">Manage Your Reservations</h1>

<div id="reservations-list" style="margin: 20px;">
  {{#if reservations.length}}
    {{#each reservations}}
      <div class="reservation-card" style="
        background: #f8f9fa;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
        border-left: 4px solid #4CAF50;
      ">
        <p><strong>Lab:</strong> {{this.lab}}</p>
        <p><strong>Date:</strong> {{this.date}}</p>
        <p><strong>Time:</strong> {{this.startTime}} - {{this.endTime}}</p>
        <p><strong>Seats:</strong> 
          {{#each this.seats}}
            {{this.seatNumber}}{{#unless @last}}, {{/unless}}
          {{/each}}
        </p>
        <button onclick="editReservation('{{this._id}}')" class="selBtn">Edit</button>
        <button onclick="deleteReservation('{{this._id}}')" class="selBtn" style="background-color: #f44336;">Delete</button>
      </div>
    {{/each}}
  {{else}}
    <p>No reservations found.</p>
  {{/if}}
</div>

<script>
  // Delete function
  async function deleteReservation(id) {
    if (confirm('Are you sure you want to delete this reservation?')) {
      try {
        await fetch(`/api/crud/reservations/${id}`, { method: 'DELETE' });
        window.location.reload();
      } catch (error) {
        console.error("Error:", error);
        alert("Error deleting reservation");
      }
    }
  }

  // Edit redirect
  function editReservation(id) {
    window.location.href = `/reservationpage?edit=${id}`;
  }
</script>

<a href="/reservationpage" class="selBtn" style="display: inline-block; margin-top: 20px;">
  ‚Üê Back to Reservation Page
</a>